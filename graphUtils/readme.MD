Functions used by langgraph, separated to improve code structure
